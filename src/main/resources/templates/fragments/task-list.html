<!-- src/main/resources/templates/fragments/task-list.html -->
<div th:fragment="task-list">
    <h3>ğŸ“‹ Lista de Tareas <span th:text="'(' + ${tasks.size()} + ')'" style="font-size: 0.8em; color: #666;"></span></h3>

    <div th:if="${#lists.isEmpty(tasks)}" class="no-tasks">
        <p>No hay tareas disponibles. Â¡Crea tu primera tarea!</p>
    </div>

    <div th:unless="${#lists.isEmpty(tasks)}" class="tasks-container">
        <div th:each="task : ${tasks}" class="task-item">
            <div class="task-header">
                <strong th:text="${task.taskName}">Nombre</strong>
                <span class="priority" th:text="'Prioridad: ' + ${task.priority}">Prioridad</span>
            </div>

            <div class="task-details">
                <p th:text="${task.description}">DescripciÃ³n</p>
                <div class="task-meta">
                    <span class="category" th:text="${task.category}">CategorÃ­a</span>
                    |
                    <span class="state" th:classappend="'state-' + ${task.state}" th:text="${task.state}">Estado</span>
                    |
                    <span class="dates">
                        Creado: <span th:text="${#temporals.format(task.createdDate, 'dd/MM/yyyy HH:mm')}"></span>
                    </span>
                    <span th:if="${task.finalDate}">
                        | Final: <span th:text="${#temporals.format(task.finalDate, 'dd/MM/yyyy HH:mm')}"></span>
                    </span>
                </div>
            </div>

            <div class="task-actions">
                <!-- Selector de estado - ACTUALIZAR -->
                <select th:data-task-id="${task.id}"
                        class="state-selector"
                        onchange="updateTaskState(this)"
                        style="width: 150px;">
                    <option th:each="st : ${T(com.todo_app.Enum.State).values()}"
                            th:value="${st}"
                            th:text="${st}"
                            th:selected="${task.state == st}">
                    </option>
                </select>

                <!-- BotÃ³n Editar - ACTUALIZAR -->
                <button class="btn-edit"
                        onclick="editTask([[${task.id}]])">
                    âœï¸ Editar
                </button>

                <!-- BotÃ³n Eliminar -->
                <button class="btn-delete"
                        th:attr="hx-delete=@{/tasks/delete/{id}(id=${task.id})}"
                        hx-target="#task-list"
                        hx-swap="innerHTML"
                        hx-confirm='Â¿EstÃ¡s seguro de que quieres eliminar esta tarea?'>
                    ğŸ—‘ï¸ Eliminar
                </button>
            </div>
        </div>
    </div>
</div>